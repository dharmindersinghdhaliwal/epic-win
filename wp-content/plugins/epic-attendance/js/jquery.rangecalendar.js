!function(e,t,n){e.fn.rangeCalendar=function(n){var a={lang:"en",theme:"default-theme",themeContext:this,startDate:moment(),endDate:moment().add("months",12),start:"-6",startRangeWidth:3,minRangeWidth:1,maxRangeWidth:1,weekends:!0,autoHideMonths:!1,visible:!0,trigger:null,changeRangeCallback:function(e,t,n){return!1}};return this.each(function(i,d){var l=d,r=e(d),s=e.extend(!0,{},a,n);l.options=s,l.showCalendar=function(n){l.calendarObj.position(),l.calendarObj.find(".cell").last().position().left,l.calendarObj.find(".cell").last().outerWidth();var a=l.calendarObj.find(".cell").eq(0).position();r.slideDown(n?300:0,function(){var n=e(t).outerWidth();e(l.calendarObj).css({left:n}),e(l.monthsObj).css({left:n}),l._placeElement(l.calendarObj,a?a.left:0),l._placeElement(l.monthsObj)}),l.visible=!0},l.hideCalendar=function(){r.slideUp(50),l.visible=!1},l.toggleCalendar=function(){l.visible?l.showCalendar():l.hideCalendar()},l.rangeWidth=function(){var e=l.calendarObj.find(".cell").outerWidth(),t=parseInt(l.calendarObj.find(".range-bar").outerWidth()/e);return l._rangeWidth=t||l._rangeWidth,l._rangeWidth},l.setRangeWidth=function(e){var t=l.calendarObj.find(".cal-cell").eq(0).outerWidth(),e=parseInt(!e||e<l.minRangeWidth?l.minRangeWidth:e);r.find(".range-bar").width(t*e),r.find(".range-bar").trigger("resize")},l.range=function(){var t=l.calendarObj.find(".cell.selected:eq(0)").index(),n=l.calendarObj.find(".cell.selected").last().index(),a=moment().add("days",t+l.start),i=t>=0?moment().add("days",t+l.start).format():null,d=n>=0?moment().add("days",n+l.start).format():null;return e.data(l,"range",{start:i,end:d,width:l.rangeWidth(),fromNow:a.fromNow()})},l.setStartDate=function(e){var t=moment(e),n=t.format("YYYY"),a=t.format("MM"),i=n+a+t.format("D"),d=n+a;l.calendarObj.find('.cell[date-id="'+i+'"]').eq(0).trigger("click"),l.monthsObj.find('.cell[month-id="'+d+'"]').eq(0).trigger("click")},l.lang=function(){return l.lang},l.setTheme=function(t){var n=e(l.themeContext).attr("theme");n&&e(l.themeContext).removeClass(n),e(l.themeContext).attr("theme",""+t),e(l.themeContext).addClass(""+t),l.theme=t},l.update=function(){console.log("update"),moment.lang(l.lang),l.setTheme(l.theme),l._generateView()},l.didResizeBar=function(){l.rangeWidth();var t=l.calendarObj.find(".range-bar").position(),n=l.calendarObj.find(".range-bar").outerWidth(),a=t.left+n,i=e(l).find(".cell").first().outerWidth(),d=e(l).find(".cell").last().position().left+i;l._dispatchEvent(l.changeRangeCallback,l.range(),l)},l.didSelectMonth=function(t){if(l.isDragging||e(l.lastTarget).is(l.monthsObj))delete l.lastTarget;else{var n=e(this).attr("month-id"),a=l.calendarObj.find('.cell[month-id="'+n+'"].selected').eq(0),i=a.length?a.position():l.calendarObj.find('.cell[month-id="'+n+'"]').eq(0).position();e(r).outerWidth();l.monthsObj.find(".cell").not(this).removeClass("selected"),e(this).addClass("selected"),l._placeElement(l.calendarObj,i),l._dispatchEvent(l.changeRangeCallback,l.range(),l)}},l.didChangeRange=function(t,n){if(l.isDragging||e(l.lastTarget).is(l.calendarObj))delete l.lastTarget;else{var a=l.rangeWidth(),i=e(this),d=l.calendarObj.find(".cell").last(),r=d.index()-i.index();i.index()+a-1>d.index()?l.calendarObj.find(" .cell").eq(i.index()-a+r+1).trigger("click"):(l._updateRangeBar(),l._updateMonths(),l._dispatchEvent(l.changeRangeCallback,l.range(),l))}},l._initRangeBar=function(){e(t).unbind("resize");var n=l.rangeWidth(),a=l.calendarObj.find(".cell").eq(0).outerWidth(),i=l.calendarObj.find(".cell").eq(0).outerHeight(),d=l.calendarObj.find(".cell.selected:eq(0)");d.length&&(l.calendarObj.find(".range-bar").unbind("resize"),l.calendarObj.find(".range-bar").remove(),e(d).append('<div class="range-bar resizable"><div class="range-bar-content"></div></div>'),l.maxRangeWidth>1&&l.calendarObj.find(".range-bar").resizable({grid:[a,0],maxWidth:l.maxRangeWidth*a,minWidth:a*l.minRangeWidth,maxHeight:i,minHeight:i,handles:"e"}),l.setRangeWidth(n),l.calendarObj.find(".range-bar").on("resize",l.didResizeBar),e(t).bind("resize",l._resize))},l._initMonths=function(){l.monthsObj.draggable({axis:"x",scrollSensitivity:100,scrollSpeed:100,cursor:"move",create:function(e,t){l._updateMonths(),l._placeElement(l.monthsObj)},start:function(e,t){l.isDragging=!0,l.monthsObj.find(".cell").unbind("click")},drag:function(e,t){},stop:function(t,n){e(this).css({top:0}),l.lastTarget=t.target,setTimeout(function(){l.isDragging=!1,delete l.lastTarget,l._placeElement(l.monthsObj),l.monthsObj.find(".cell").bind("click",l.didSelectMonth)},10)}})},l._initCalendar=function(){var n;l.calendarObj.draggable({axis:"x",scrollSensitivity:100,scrollSpeed:100,cursor:"move",create:function(){l.calendarObj.find(".cell").removeClass("selected"),l.calendarObj.find(".cell").removeClass("last"),l.calendarObj.find(".cell").eq(l.start-1).addClass("start"),l.calendarObj.find(".cell").eq(l.start-1).addClass("selected"),l.calendarObj.find(".cell.start").nextAll().slice(0,l._rangeWidth-1).addClass("selected"),l.calendarObj.find(".cell").bind("click",l.didChangeRange),l.calendarObj.find(".cell.selected").last().addClass("last"),l._placeElement(l.calendarObj)},start:function(a,i){n=i.position.left,e(t).unbind("resize"),l.isDragging=!0,l.calendarObj.find(".cell").unbind("click")},drag:function(t,a){var i=a.position.left-n>=0?"right":"left",d=r.outerWidth(),s=l.calendarObj.position(),c=parseInt(l.monthsObj.find(".cell").last().attr("month-id")),o=parseInt(l.monthsObj.find(".cell").first().attr("month-id")),h=parseInt(l.monthsObj.find(".cell.selected").attr("month-id")),m=parseInt(l.monthsObj.find(".cell.selected").next().attr("month-id")),g=parseInt(l.monthsObj.find(".cell.selected").prev().attr("month-id"));if(m&&h&&m<=c&&"left"==i){var f=l.monthsObj.find('.cell[month-id="'+m+'"]');d/2-l.calendarObj.find('.cell[month-id="'+m+'"]').first().position().left>=s.left&&0!=s.left&&(l.monthsObj.find(".cell").removeClass("selected"),e(f).addClass("selected"),l._placeElement(l.monthsObj,f.position()))}else if(g&&h&&g>=o&&"right"==i){var b=l.monthsObj.find('.cell[month-id="'+g+'"]'),u=l.calendarObj.find('.cell[month-id="'+g+'"]').last();d/2-u.position().left<=s.left+u.outerWidth()&&(l.monthsObj.find(".cell").removeClass("selected"),e(b).addClass("selected"),l._placeElement(l.monthsObj,b.position()))}},stop:function(n,a){l.lastTarget=n.target,l._placeElement(l.calendarObj),setTimeout(function(){l.isDragging=!1,delete l.lastTarget,l.calendarObj.find(".cell").bind("click",l.didChangeRange),e(t).bind("resize",l._resize),l._placeElement(l.monthsObj)},100)}})},l._attachDragEasing=function(e){return},l._getCalendarHTML=function(e,t){for(var n,a="",i=moment(e).add("days",l.start),t=moment(t).add("days",l.start),d=(l.rangeWidth(),1);i.isBefore(t)||i.isSame(t);d++){var r=i.format("YYYY"),s=i.format("MMM"),c=i.format("MM"),o=i.format("ddd"),h=i.format("D"),m=i.day()%6==0,g=i.format("YY");!m||l.weekends?(n='<div class="cal-cell cell " date-id="'+r+c+h+'" month-id="'+r+c+'" month="'+c+'">',n+='<div class="cell-content">',n+='<div class="day '+(m?"ferial":"")+'">'+o+"</div>",n+='<div class="day-number">'+h+"</div>",n+='<input  type="hidden"class="mnth" name="mnth" value="'+s+'">',n+='<input  type="hidden"class="yer" name="yer"value="20'+g+'">',n+='<a  href="javascript:void(0)" class="class-count">Classes</a>',n+="</div>",a+=n+="</div>",i.add("days",1)):i.add("days",1)}return a},l._getMonthsHTML=function(e,t){for(var n,a="",i=moment(e).add("days",l.start),t=moment(t).add("days",l.start),d=1;i.isBefore(t)||i.isSame(t);d++){var r=i.format("YY"),s=i.format("YYYY"),c=i.format("MMM"),o=i.format("MM");n='<div class="month-cell cell" month-id="'+s+o+'" month="'+o+'">',n+='<i class="bullet"></i>',n+='<div class="date-formatted"><span class="month-name">'+c+"</span> 20"+r+"</span></div>",a+=n+="</div>",i.add("month",1)}return a},l._updateMonths=function(){l.calendarObj.find(".cell.selected:eq(0)").attr("month-id")},l._updateRangeBar=function(){l.didResizeBar(),l._initRangeBar()},l._dispatchEvent=function(e,t,n){if(!e)return!1;e(n,t)},l._placeElement=function(e){l._placeElement(e,null)},l._placeElement=function(t,n){var a=r.outerWidth(),i=e(t).find(".cell").first().outerWidth(),d=e(t).children().length*i,l=e(t).position();left=n?-n.left:parseInt(l.left),a>d?left=(a-d)/2:a<d&&left>=0?left=0:left<a-d&&(left=-d+a),e(t).stop().animate({left:left},300,"easeOutCirc")},l._timedResize=function(){clearTimeout(l.resizeTimer),l.resizeTimer=setTimeout(l._resize,l.timeoutTime)},l._bindEvents=function(){l.trigger&&(e(l.trigger).unbind("click"),e(l.trigger).click(l.toggleCalendar)),l.timeout=!1,l.timeoutTime=100,l.calendarObj.find(".range-bar").on("resize",l.didResizeBar),l.monthsObj.find(".cell").bind("click",l.didSelectMonth),e(t).bind("resize",l._timedResize),r.hover(function(){l.autoHideMonths&&l.monthsObj.slideDown(100,"easeOutCirc")},function(){l.autoHideMonths&&l.monthsObj.slideUp(0,"easeOutCirc")}),e(l).on("mousedown",".range-bar",function(t){var n=document.elementFromPoint(t.clientX,t.clientY);if(e(n).hasClass("ui-resizable-handle"))return t.stopPropagation(),!1}),e(l).on("mouseup",".range-bar",function(t){if(e(l).find(".range-bar").hasClass("ui-resizable-resizing"))return!0;e(this).hide();var n=document.elementFromPoint(t.clientX,t.clientY);return e(this).show(),e(n).trigger("click"),!0})},l._resize=function(){l._placeElement(l.calendarObj),l._placeElement(l.monthsObj),l.timeout=!1},l._updateView=function(e,t){l.calendarObj.append(l._getCalendarHTML(e,t)),l.monthsObj.append(l._getMonthsHTML(e,t)),l.visible?(r.css({display:"block"}),l.showCalendar()):r.css({display:"none"}),l._initCalendar(),l._initMonths(),l._initRangeBar(),l._attachDragEasing(l.calendarObj)},l._generateView=function(){r.removeClass("range-calendar"),r.addClass("range-calendar"),r.empty(),l.monthsObj=e('<div class="wrapper"><div class="months"></div></div>'),r.append(l.monthsObj),l.monthsObj=l.monthsObj.find(".months"),l.autoHideMonths&&l.monthsObj.addClass("auto-hide-months"),l.calendarObj=e('<div class="wrapper"><div class="calendar"></div></div>'),r.append(l.calendarObj),l.calendarObj=l.calendarObj.find(".calendar"),l._updateView(l.startDate,l.endDate),l._bindEvents(),l._dispatchEvent(l.changeRangeCallback,l.range(),l)},l._init=function(e,t){l.themeContext=t.themeContext,l.lang=t.lang,l.isDragging=!1,l.minRangeWidth=t.minRangeWidth,l.maxRangeWidth=t.maxRangeWidth,l.weekends=t.weekends,l.startDate=t.startDate,l.endDate=t.endDate,l.start=t.start?parseInt(t.start):"+7",l.startRangeWidth=t.startRangeWidth>t.maxRangeWidth?t.maxRangeWidth:t.startRangeWidth,l._rangeWidth=l.startRangeWidth,l.trigger=t.trigger,l.visible=t.visible,l.changeRangeCallback=t.changeRangeCallback,l.autoHideMonths=t.autoHideMonths,l.theme=t.theme?t.theme:a.theme,l.update()},l._init(d,l.options),e(l).data("rangeCalendar",l)}),this.data("rangeCalendar")}}(jQuery,window);
var WPUltimateEPostGrid=WPUltimateEPostGrid||{};WPUltimateEPostGrid.grids={},WPUltimateEPostGrid.initEgrid=function(t){var i=t.data("grid"),e={itemSelector:".wpupg-item",transitionDuration:wpupg_public.animationSpeed,hiddenStyle:{opacity:0},visibleStyle:{opacity:1}},r=t.data("layout-mode");r&&(e.layoutMode=r),"masonry"==r&&t.data("centered")&&(e.masonry={isFitWidth:!0}),t.isotope(e),t.imagesLoaded(function(){t.isotope("layout")}),WPUltimateEPostGrid.grids[i]={container:t,centered:t.data("centered"),pages:[0],page:0,filters:{}},WPUltimateEPostGrid.checkLinks(i)},WPUltimateEPostGrid.filterEgrid=function(t){var i=WPUltimateEPostGrid.grids[t],e=[];if("load_more"!=i.pagination_type){var r=i.page||0;e.push([".wpupg-page-"+r])}for(var a in i.filters)if(i.filters.hasOwnProperty(a)){var o=i.filters[a],s=[],c="";if(o)for(var d=0;d<o.length;d++)"match_one"==i.multiselect_type?s.push(".wpupg-tax-"+a+"-"+o[d]):c+=".wpupg-tax-"+a+"-"+o[d];"match_one"==i.multiselect_type?s.length>0&&e.push(s):""!==c&&e.push([c])}i.filter="",WPUltimateEPostGrid.getFilterString(t,"",e,0),i.container.isotope({filter:i.filter}),i.container.trigger("wpupgFiltered"),WPUltimateEPostGrid.updateDeeplink()},WPUltimateEPostGrid.getFilterString=function(t,i,e,r){if(r==e.length)""!==WPUltimateEPostGrid.grids[t].filter&&(i=", "+i),WPUltimateEPostGrid.grids[t].filter+=i;else for(var a=0;a<e[r].length;a++)WPUltimateEPostGrid.getFilterString(t,i+e[r][a],e,r+1)},WPUltimateEPostGrid.updateDeeplink=function(){var t="";for(var i in WPUltimateEPostGrid.grids)if(WPUltimateEPostGrid.grids.hasOwnProperty(i)){var e=WPUltimateEPostGrid.grids[i],r="";0!=e.page&&(r+="|p:"+(e.page+1));for(var a in e.filters)if(e.filters.hasOwnProperty(a)){var o=e.filters[a];o.length>0&&(r+="|"+a+":"+o.join(","))}""!=r&&(""!=t&&(t+="#"),t+=i,t+=r)}""==t&&(t="*"),document.location.hash=t},WPUltimateEPostGrid.restoreDeeplink=function(){var t=document.location.hash;if(t=t.substr(1),t&&"*"!=t){t=t.replace("%23","#"),t=t.replace("%7C","|"),t=t.replace("%3A",":"),t=t.replace("%2C",",");for(var i=t.split("#"),e=0;e<i.length;e++)for(var r=i[e].split("|"),a=r[0],o=1;o<r.length;o++){var s=r[o].split(":");if("p"==s[0]){var c=parseInt(s[1])-1;WPUltimateEPostGrid.updatePagination(jQuery("#wpupg-egrid-"+a+"-pagination"),c)}else{var d=s[1].split(",");WPUltimateEPostGrid.updateFilter(jQuery("#wpupg-egrid-"+a+"-filter"),s[0],d)}}}},WPUltimateEPostGrid.checkLinks=function(t){var i=WPUltimateEPostGrid.grids[t],e=i.container.data("link-type"),r=i.container.data("link-target");"none"!=e&&i.container.find(".wpupg-item").each(function(){var t=jQuery(this),i=t.attr("id"),i=i.replace("wpuep-container-exercise-","");t.find("a:not(.wpupg-keep-link, .wpuep-exercise-favorite, .wpuep-exercise-add-to-shopping-list, .wpuep-exercise-print-button, .wpuep-exercise-grid-link)").each(function(){var t=jQuery(this);0==t.parents(".sharrre").length&&t.replaceWith(function(){return t.contents()})});var a="post"==r?t.data("permalink"):t.data("image"),o="post"==r?"":' rel="lightbox"',s=wpuep_user_menus.ajaxurl;s+="&action=exercise_email_program&exercise_id="+i+"&height=550&width=800";var c=t.find(".wpuep-exercise-image");c&&c.wrap('<a class="thickbox" href="'+s+'"></a>'),a&&0==t.parent("a").length&&t.wrap('<a target="'+e+'"'+o+"></a>")})},WPUltimateEPostGrid.updateFilter=function(t,i,e){var r=t.data("type"),a="updateFilter"+r.charAt(0).toUpperCase()+r.slice(1);"function"==typeof WPUltimateEPostGrid[a]&&WPUltimateEPostGrid[a](t,i,e)},WPUltimateEPostGrid.updateFilterIsotope=function(t,i,e){for(var r=0;r<e.length;r++)t.find(".wpupg-efilter-tag-"+e[r]).click()},WPUltimateEPostGrid.initFilterIsotope=function(t){var i=t.data("grid");WPUltimateEPostGrid.grids[i].multiselect=t.data("multiselect"),WPUltimateEPostGrid.grids[i].multiselect_type=t.data("multiselect-type"),t.find(".wpupg-efilter-isotope-term").click(function(){var t=jQuery(this),e=t.data("taxonomy"),r=void 0==t.data("filter"),a=t.data("filter"),o=[];if(WPUltimateEPostGrid.grids[i].multiselect&&!r){t.siblings(".wpupg-efilter-tag-").removeClass("active").trigger("checkActiveFilter"),o=WPUltimateEPostGrid.grids[i].filters||[],void 0==o[e]&&(o[e]=[]);var s=o[e].indexOf(a);if(-1==s)t.addClass("active").trigger("checkActiveFilter"),o[e].push(a);else{t.removeClass("active").trigger("checkActiveFilter"),o[e].splice(s,1);var c=0;for(var d in o)if(o.hasOwnProperty(d)){var l=o[d];l&&(c+=l.length)}0==c&&t.siblings(".wpupg-efilter-tag-").addClass("active").trigger("checkActiveFilter")}}else t.siblings(".wpupg-efilter-isotope-term").removeClass("active").trigger("checkActiveFilter"),t.addClass("active").trigger("checkActiveFilter"),r||(o[e]=[a]);WPUltimateEPostGrid.grids[i].filters=o,WPUltimateEPostGrid.filterEgrid(i)});var e=t.data("filter-type"),r=t.find(".wpupg-efilter-item");if("isotope"==e){var a=t.data("margin-vertical")+"px "+t.data("margin-horizontal")+"px",o=t.data("padding-vertical")+"px "+t.data("padding-horizontal")+"px",s=t.data("border-width")+"px solid "+t.data("border-color"),c=t.data("background-color"),d=t.data("text-color"),l=t.data("border-width")+"px solid "+t.data("active-border-color"),n=t.data("active-background-color"),p=t.data("active-text-color"),g=t.data("border-width")+"px solid "+t.data("hover-border-color"),u=t.data("hover-background-color"),P=t.data("hover-text-color");r.each(function(){var t=jQuery(this);t.css("margin",a).css("padding",o).css("border",s).css("background-color",c).css("color",d).hover(function(){t.hasClass("active")||t.css("border",g).css("background-color",u).css("color",P)},function(){t.hasClass("active")||t.css("border",s).css("background-color",c).css("color",d)}).on("checkActiveFilter",function(){t.hasClass("active")?t.css("border",l).css("background-color",n).css("color",p):t.css("border",s).css("background-color",c).css("color",d)}).trigger("checkActiveFilter")})}},WPUltimateEPostGrid.updatePagination=function(t,i){var e=t.data("type"),r="updatePagination"+e.charAt(0).toUpperCase()+e.slice(1);"function"==typeof WPUltimateEPostGrid[r]&&WPUltimateEPostGrid[r](t,i)},WPUltimateEPostGrid.updatePaginationPages=function(t,i){t.find(".wpupg-page-"+i).click()},WPUltimateEPostGrid.initPaginationPages=function(t){var i=t.data("grid");t.find(".wpupg-pagination-term").click(function(){var t=jQuery(this);t.siblings(".wpupg-pagination-term").removeClass("active").trigger("checkActiveFilter");var e=parseInt(t.addClass("active").trigger("checkActiveFilter").data("page"));if(-1!==WPUltimateEPostGrid.grids[i].pages.indexOf(e))WPUltimateEPostGrid.grids[i].page=e,WPUltimateEPostGrid.filterEgrid(i);else{var r={action:"wpupg_get_page",security:wpupg_public.nonce,grid:i,page:e};t.addClass("wpupg-spinner"),t.css("color",WPUltimateEPostGrid.grids[i].pagination_style.active_background_color),jQuery.post(wpupg_public.ajax_url,r,function(r){var a=jQuery(r).toArray();WPUltimateEPostGrid.grids[i].container.isotope("insert",a),WPUltimateEPostGrid.grids[i].page=e,WPUltimateEPostGrid.filterEgrid(i),WPUltimateEPostGrid.checkLinks(i),WPUltimateEPostGrid.grids[i].container.imagesLoaded(function(){WPUltimateEPostGrid.grids[i].container.isotope("layout")}),t.removeClass("wpupg-spinner"),t.css("color",WPUltimateEPostGrid.grids[i].pagination_style.active_text_color),WPUltimateEPostGrid.grids[i].pages.push(e)})}});var e=t.find(".wpupg-pagination-term"),r=t.data("margin-vertical")+"px "+t.data("margin-horizontal")+"px",a=t.data("padding-vertical")+"px "+t.data("padding-horizontal")+"px",o=t.data("border-width")+"px solid "+t.data("border-color"),s=t.data("background-color"),c=t.data("text-color"),d=t.data("border-width")+"px solid "+t.data("active-border-color"),l=t.data("active-background-color"),n=t.data("active-text-color"),p=t.data("border-width")+"px solid "+t.data("hover-border-color"),g=t.data("hover-background-color"),u=t.data("hover-text-color");WPUltimateEPostGrid.grids[i].pagination_style={margin:r,padding:a,border:o,background_color:s,text_color:c,active_border:d,active_background_color:l,active_text_color:n,hover_border:p,hover_background_color:g,hover_text_color:u},e.each(function(){var t=jQuery(this);t.css("margin",r).css("padding",a).css("border",o).css("background-color",s).css("color",c).hover(function(){t.hasClass("active")||t.css("border",p).css("background-color",g).css("color",u)},function(){t.hasClass("active")||t.css("border",o).css("background-color",s).css("color",c)}).on("checkActiveFilter",function(){t.hasClass("active")?t.css("border",d).css("background-color",l).css("color",n):t.css("border",o).css("background-color",s).css("color",c)}).trigger("checkActiveFilter")})},jQuery(document).ready(function(t){t(".wpupg-egrid").each(function(){WPUltimateEPostGrid.initEgrid(t(this))}),t(".wpupg-efilter").each(function(){var i=t(this),e=i.data("grid"),r=i.data("type");WPUltimateEPostGrid.grids[e].filter_type=r;var a="initFilter"+r.charAt(0).toUpperCase()+r.slice(1);"function"==typeof WPUltimateEPostGrid[a]&&WPUltimateEPostGrid[a](i)}),t(".wpupg-pagination").each(function(){var i=t(this),e=i.data("grid"),r=i.data("type");WPUltimateEPostGrid.grids[e].pagination_type=r;var a="initPagination"+r.charAt(0).toUpperCase()+r.slice(1);"function"==typeof WPUltimateEPostGrid[a]&&WPUltimateEPostGrid[a](i)}),WPUltimateEPostGrid.restoreDeeplink()});